<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹±17è®°å¿†è®­ç»ƒå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background-color: #4a6ee0;
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .progress-bar {
            height: 4px;
            background-color: rgba(255, 255, 255, 0.3);
            margin-top: 15px;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background-color: white;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .main-area {
            padding: 40px 30px;
            text-align: center;
        }
        
        .radical-display {
            font-size: 120px;
            font-weight: bold;
            color: #333;
            margin-bottom: 30px;
            height: 160px;
            display-flex: flex;
            align-items: center;
            justify-content: center;
        }
        
        .input-container {
            margin-bottom: 25px;
        }
        
        .input-label {
            display: block;
            margin-bottom: 10px;
            color: #666;
            font-size: 1rem;
        }
        
        .key-input {
            width: 100%;
            padding: 16px;
            font-size: 1.5rem;
            text-align: center;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            outline: none;
            transition: all 0.3s ease;
            font-weight: bold;
            letter-spacing: 2px;
        }
        
        .key-input:focus {
            border-color: #4a6ee0;
            box-shadow: 0 0 0 3px rgba(74, 110, 224, 0.2);
        }
        
        .key-input.correct {
            border-color: #10b981;
            background-color: #d1fae5;
        }
        
        .key-input.incorrect {
            border-color: #ef4444;
            background-color: #fee2e2;
        }
        
        .result-message {
            height: 24px;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .result-message.correct {
            color: #10b981;
        }
        
        .result-message.incorrect {
            color: #ef4444;
        }
        
        .hint-area {
            background-color: #f8fafc;
            border-radius: 10px;
            padding: 15px;
            margin-top: 25px;
        }
        
        .hint-title {
            font-size: 0.9rem;
            color: #4a6ee0;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .hint-text {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background-color: #f8fafc;
            padding: 15px;
            border-top: 1px solid #e5e7eb;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4a6ee0;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 3px;
        }
        
        .level-info {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            padding: 8px 15px;
            background-color: #f0f7ff;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .level-badge {
            background-color: #4a6ee0;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.85rem;
            border-top: 1px solid #e5e7eb;
        }
        
        @media (max-width: 600px) {
            .radical-display {
                font-size: 90px;
                height: 120px;
            }
            
            .main-area {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ä¹±17è®°å¿†è®­ç»ƒå™¨</h1>
            <p class="subtitle">éšæœºè®­ç»ƒ â€¢ é”™è¯¯å¿…é¡»çº æ­£</p>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
        </div>
        
        <div class="main-area">
            <div class="level-info">
                å½“å‰ç›®æ ‡: æ¯å­—æ ¹è¿ç»­æ­£ç¡®
                <span class="level-badge" id="target-count">3</span> æ¬¡
            </div>
            
            <div class="radical-display" id="radical-display">?</div>
            
            <div class="input-container">
                <!-- <div class="input-label" id="input-label">è¾“å…¥å¯¹åº”çš„æŒ‰é”®ï¼š</div> -->
                <input 
                    type="text" 
                    class="key-input" 
                    id="key-input" 
                    placeholder="æŒ‰å¯¹åº”é”®..."
                    autocomplete="off"
                    autocapitalize="off"
                    spellcheck="false"
                    maxlength="1"
                >
            </div>
            
            <div class="result-message" id="result-message"></div>
            
            <div class="hint-area">
                <div class="hint-title">ä½¿ç”¨è¯´æ˜</div>
                <div class="hint-text">
                    1. å¦‚æœ3ç§’å†…æƒ³ä¸èµ·æ¥ç›´æ¥éšä¾¿æŒ‰ä¸€ä¸ªé”®<br>
                    2. è¾“å…¥é”™è¯¯ä¼šå¢åŠ è¯¥éŸ³å‡ºç°é¢‘æ¬¡<br>
                </div>
            </div>
        </div>
        
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="remaining-count">56</div>
                <div class="stat-label">å¾…å®Œæˆ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="current-level">1</div>
                <div class="stat-label">é˜¶æ®µ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="correct-rate">0%</div>
                <div class="stat-label">æ­£ç¡®ç‡</div>
            </div>
        </div>
        
        <div class="footer">
            <p>éšæœºè®­ç»ƒç®—æ³• â€¢ é”™è¯¯å¿…é¡»çº æ­£</p>
        </div>
    </div>

    <script>
        // å­—æ ¹æ•°æ® - å•æŒ‰é”®å­—æ ¹
        const radicals = [
            { radical: 'uai', key: 'x' },
            { radical: 'in', key: 's'},
            { radical: 'n', key: 'n' },
            { radical: 'ui', key: 'c' },
            { radical: 'w', key: 'w' },
            { radical: 'zh', key: 'z' },
            { radical: 'e', key: 'w' },
            { radical: 'iu', key: 'f' },
            { radical: 'ou', key: 'f' },
            { radical: 'ong', key: 't' },
            { radical: 'eng', key: 'y' },
            { radical: 'en', key: 's'},
            { radical: 't', key: 't' },
            { radical: 'iao', key: 'z' },
            { radical: 'b', key: 'b' },
            { radical: 'q', key: 'q' },
            { radical: 'an', key: 'n' },
            { radical: 'i', key: 'j' },
            { radical: 'l', key: 'l' },
            { radical: 'ing', key: 'y' },
            { radical: 'x', key: 'x' },
            { radical: 'd', key: 'd'},
            { radical: 'er', key: 't' },
            { radical: 'u', key: 'd'},
            { radical: 'ua', key: 'h' },
            { radical: 'uan', key: 'x' },
            { radical: 'v', key: 'x' },
            { radical: 'ai', key: 'l' },
            { radical: 'm', key: 'm'},
            { radical: 'ian', key: 'q' },
            { radical: 't', key: 't' },
            { radical: 'iong', key: 'b' },
            { radical: 'a', key: 'h' },
            { radical: 'f', key: 'f' },
            { radical: 'ie', key: 'm'},
            { radical: 'ei', key: 'g' },
            { radical: 'uang', key: 'q' },
            { radical: 'uo', key: 'm'},
            { radical: 'sh', key: 's'},
            { radical: 'c', key: 'f' },
            { radical: 'ia', key: 'h' },
            { radical: 'ao', key: 'b' },
            { radical: 'g', key: 'g' },
            { radical: 'h', key: 'h' },
            { radical: 'k', key: 'j' },
            { radical: 'o', key: 'x' },
            { radical: 'p', key: 'h' },
            { radical: 'r', key: 'n' },
            { radical: 'iang', key: 'c' },
            { radical: 'z', key: 'w' },
            { radical: 'y', key: 'y' },
            { radical: 's', key: 'm'},
            { radical: 'un', key: 'g' },
            { radical: 'ang', key: 'z' },
            { radical: 'j', key: 'j' },
            { radical: 'ue', key: 'l' },
            { radical: 'ch', key: 'c' },
        ];
        
        // ç›®æ ‡åºåˆ—: 3 â†’ 5 â†’ 8 â†’ 12 â†’ 17 â†’ 23 â†’ 30 â†’ ...
        const TARGET_SEQUENCE = [3, 5, 8, 12, 17, 23, 30];
        
        // è®­ç»ƒå™¨ä¸»ç±»
        class RandomRadicalTrainer {
            constructor() {
                this.radicals = radicals;
                this.currentRadical = null;
                this.stats = {
                    totalAttempts: 0,
                    correctAttempts: 0,
                    currentStreak: 0,
                    bestStreak: 0
                };
                
                // åŠ è½½æ‰€æœ‰çŠ¶æ€
                this.loadAllStates();
                
                // åˆå§‹åŒ–è®­ç»ƒå‚æ•°
                this.currentLevel = this.savedState.currentLevel || 0;
                this.targetCount = TARGET_SEQUENCE[this.currentLevel] || TARGET_SEQUENCE[0];
                
                this.initElements();
                this.bindEvents();
                this.updateRemainingCards();
                this.nextRadical();
            }
            
            // åˆå§‹åŒ–DOMå…ƒç´ 
            initElements() {
                this.radicalDisplay = document.getElementById('radical-display');
                this.keyInput = document.getElementById('key-input');
                this.resultMessage = document.getElementById('result-message');
                this.inputLabel = document.getElementById('input-label');
                this.progressBar = document.getElementById('progress');
                this.remainingCount = document.getElementById('remaining-count');
                this.currentLevelEl = document.getElementById('current-level');
                this.correctRate = document.getElementById('correct-rate');
                this.targetCountEl = document.getElementById('target-count');
            }
            
            // ç»‘å®šäº‹ä»¶
            bindEvents() {
                this.keyInput.addEventListener('input', (e) => this.handleInput(e));
                this.keyInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        this.checkAnswer();
                    }
                });
                
                // é¡µé¢åŠ è½½åè‡ªåŠ¨èšç„¦è¾“å…¥æ¡†
                window.addEventListener('load', () => {
                    this.keyInput.focus();
                });
            }
            
            // åŠ è½½æ‰€æœ‰çŠ¶æ€
            loadAllStates() {
                // åŠ è½½å¡ç‰‡çŠ¶æ€
                const cardStatesKey = 'randomRadicalCardStates';
                const savedCardStates = localStorage.getItem(cardStatesKey);
                this.cardStates = {};
                
                if (savedCardStates) {
                    this.cardStates = JSON.parse(savedCardStates);
                }
                
                // ç¡®ä¿æ‰€æœ‰å­—æ ¹éƒ½æœ‰åˆå§‹çŠ¶æ€
                this.radicals.forEach(radical => {
                    const key = radical.radical;
                    if (!this.cardStates[key]) {
                        this.cardStates[key] = {
                            successCount: 0,  // å½“å‰é˜¶æ®µæˆåŠŸæ¬¡æ•°
                            totalSuccess: 0,  // ç´¯è®¡æ€»æˆåŠŸæ¬¡æ•°
                            level: 0          // å½“å‰è¾¾åˆ°çš„é˜¶æ®µ
                        };
                    }
                });
                
                // åŠ è½½ç¨‹åºçŠ¶æ€
                const appStateKey = 'randomRadicalAppState';
                const savedAppState = localStorage.getItem(appStateKey);
                this.savedState = savedAppState ? JSON.parse(savedAppState) : {
                    currentLevel: 0,
                    stats: {
                        totalAttempts: 0,
                        correctAttempts: 0,
                        bestStreak: 0
                    }
                };
                
                // æ¢å¤ç»Ÿè®¡
                this.stats = {
                    ...this.stats,
                    ...this.savedState.stats
                };
            }
            
            // ä¿å­˜æ‰€æœ‰çŠ¶æ€
            saveAllStates() {
                // ä¿å­˜å¡ç‰‡çŠ¶æ€
                localStorage.setItem('randomRadicalCardStates', JSON.stringify(this.cardStates));
                
                // ä¿å­˜ç¨‹åºçŠ¶æ€
                const appState = {
                    currentLevel: this.currentLevel,
                    stats: {
                        totalAttempts: this.stats.totalAttempts,
                        correctAttempts: this.stats.correctAttempts,
                        bestStreak: this.stats.bestStreak
                    }
                };
                localStorage.setItem('randomRadicalAppState', JSON.stringify(appState));
            }
            
            // é‡ç½®æ‰€æœ‰çŠ¶æ€ï¼ˆå¯é€‰åŠŸèƒ½ï¼Œç”¨äºé‡æ–°å¼€å§‹ï¼‰
            resetAllStates() {
                // é‡ç½®å¡ç‰‡çŠ¶æ€
                this.radicals.forEach(radical => {
                    this.cardStates[radical.radical] = {
                        successCount: 0,
                        totalSuccess: 0,
                        level: 0
                    };
                });
                
                // é‡ç½®ç¨‹åºçŠ¶æ€
                this.currentLevel = 0;
                this.targetCount = TARGET_SEQUENCE[0];
                this.stats = {
                    totalAttempts: 0,
                    correctAttempts: 0,
                    currentStreak: 0,
                    bestStreak: 0
                };
                
                this.saveAllStates();
                this.updateRemainingCards();
                this.updateDisplay();
            }
            
            // æ›´æ–°å¾…å®Œæˆçš„å¡ç‰‡åˆ—è¡¨
            updateRemainingCards() {
                // æ‰¾å‡ºæ‰€æœ‰åœ¨å½“å‰é˜¶æ®µè¿˜æœªè¾¾åˆ°ç›®æ ‡çš„å¡ç‰‡
                this.remainingCards = this.radicals.filter(radical => {
                    const state = this.cardStates[radical.radical];
                    return state.level < this.currentLevel || 
                          (state.level === this.currentLevel && state.successCount < this.targetCount);
                });
                
                // å¦‚æœå½“å‰é˜¶æ®µæ‰€æœ‰å¡ç‰‡éƒ½å®Œæˆäº†ï¼Œè¿›å…¥ä¸‹ä¸€é˜¶æ®µ
                if (this.remainingCards.length === 0 && this.currentLevel < TARGET_SEQUENCE.length - 1) {
                    this.currentLevel++;
                    this.targetCount = TARGET_SEQUENCE[this.currentLevel];
                    
                    // é‡ç½®æ‰€æœ‰å¡ç‰‡çš„å½“å‰é˜¶æ®µæˆåŠŸæ¬¡æ•°
                    this.radicals.forEach(radical => {
                        this.cardStates[radical.radical].level = this.currentLevel;
                        this.cardStates[radical.radical].successCount = 0;
                    });
                    
                    // é‡æ–°è®¡ç®—å‰©ä½™å¡ç‰‡
                    this.updateRemainingCards();
                    
                    // æ˜¾ç¤ºå‡çº§æ¶ˆæ¯
                    this.showLevelUpMessage();
                    
                    // ä¿å­˜çŠ¶æ€
                    this.saveAllStates();
                }
            }
            
            // æ˜¾ç¤ºå‡çº§æ¶ˆæ¯
            showLevelUpMessage() {
                this.resultMessage.textContent = `ğŸ‰ æ­å–œï¼è¿›å…¥ç¬¬ ${this.currentLevel + 1} é˜¶æ®µï¼Œæ–°ç›®æ ‡: ${this.targetCount} æ¬¡`;
                this.resultMessage.className = 'result-message correct';
                
                // æ›´æ–°æ˜¾ç¤º
                this.updateDisplay();
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                this.keyInput.value = '';
                this.keyInput.className = 'key-input';
                
                // 2ç§’åæ˜¾ç¤ºä¸‹ä¸€ä¸ªå­—æ ¹
                setTimeout(() => {
                    this.nextRadical();
                }, 2000);
            }
            
            // éšæœºè·å–ä¸‹ä¸€ä¸ªå­—æ ¹ï¼ˆä»å‰©ä½™å¡ç‰‡ä¸­éšæœºé€‰æ‹©ï¼‰
            nextRadical() {
                if (this.remainingCards.length === 0) {
                    // æ‰€æœ‰é˜¶æ®µéƒ½å®Œæˆäº†ï¼Œæ˜¾ç¤ºå®Œæˆæ¶ˆæ¯
                    this.radicalDisplay.textContent = 'ğŸ¯';
                    this.inputLabel.textContent = 'æ­å–œï¼æ‰€æœ‰è®­ç»ƒå·²å®Œæˆï¼';
                    this.keyInput.disabled = true;
                    this.resultMessage.textContent = 'æ‚¨å·²æŒæ¡æ‰€æœ‰å­—æ ¹ï¼';
                    return;
                }
                
                // ä»å‰©ä½™å¡ç‰‡ä¸­éšæœºé€‰æ‹©ä¸€ä¸ª
                const randomIndex = Math.floor(Math.random() * this.remainingCards.length);
                this.currentRadical = this.remainingCards[randomIndex];
                
                // æ›´æ–°æ˜¾ç¤º
                this.radicalDisplay.textContent = this.currentRadical.radical;
                const keyMap = new Map();
                keyMap['h'] = '1-1'
                keyMap['s'] = '1-2'
                keyMap['z'] = '1-3'
                keyMap['b'] = '1-4'
                keyMap['x'] = '1-5'
                keyMap['m'] = '1-6'
                keyMap['l'] = '2-1'
                keyMap['d'] = '2-2'
                keyMap['y'] = '2-3'
                keyMap['w'] = '2-4'
                keyMap['j'] = '2-5'
                keyMap['n'] = '2-6'
                keyMap['c'] = '3-1'
                keyMap['q'] = '3-2'
                keyMap['g'] = '3-3'
                keyMap['f'] = '3-4'
                keyMap['t'] = '3-5'
                // this.inputLabel.textContent = `è¾“å…¥ "${this.currentRadical.radical}" å¯¹åº”çš„æŒ‰é”® (${keyMap[this.currentRadical.key]})ï¼š`;
                
                // é‡ç½®è¾“å…¥æ¡†
                this.keyInput.value = '';
                this.keyInput.className = 'key-input';
                this.keyInput.focus();
                
                // æ¸…ç©ºç»“æœæ¶ˆæ¯
                this.resultMessage.textContent = '';
                this.resultMessage.className = 'result-message';
                
                // æ›´æ–°è¿›åº¦å’Œç»Ÿè®¡
                this.updateDisplay();
                
                // è¾“å‡ºå½“å‰å¡ç‰‡è¿›åº¦åˆ°æ§åˆ¶å°
                this.logProgress();
            }
            
            // å¤„ç†è¾“å…¥
            handleInput(e) {
                const value = e.target.value.toLowerCase();
                
                // å¦‚æœè¾“å…¥ä¸ä¸ºç©ºï¼Œç«‹å³æ£€æŸ¥ç­”æ¡ˆ
                if (value.length > 0) {
                    this.checkAnswer();
                }
            }
            
            // æ£€æŸ¥ç­”æ¡ˆ
            checkAnswer() {
                const userInput = this.keyInput.value.toLowerCase();
                const correctKey = this.currentRadical.key.toLowerCase();
                
                // æ›´æ–°æ€»å°è¯•æ¬¡æ•°
                this.stats.totalAttempts++;
                
                // æ£€æŸ¥ç­”æ¡ˆæ˜¯å¦æ­£ç¡®
                if (userInput === correctKey) {
                    // ç­”æ¡ˆæ­£ç¡®
                    this.handleCorrectAnswer();
                } else {
                    // ç­”æ¡ˆé”™è¯¯
                    this.handleIncorrectAnswer();
                }
                
                // ä¿å­˜çŠ¶æ€
                this.saveAllStates();
                
                // è¾“å‡ºè¿›åº¦åˆ°æ§åˆ¶å°
                this.logProgress();
                
                // æ›´æ–°æ˜¾ç¤º
                this.updateDisplay();
            }
            
            // å¤„ç†æ­£ç¡®ç­”æ¡ˆ
            handleCorrectAnswer() {
                // æ›´æ–°ç»Ÿè®¡
                this.stats.correctAttempts++;
                this.stats.currentStreak++;
                this.stats.bestStreak = Math.max(this.stats.bestStreak, this.stats.currentStreak);
                
                // æ›´æ–°å½“å‰å¡ç‰‡çŠ¶æ€
                const cardState = this.cardStates[this.currentRadical.radical];
                cardState.successCount++;
                cardState.totalSuccess++;
                
                // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°å½“å‰é˜¶æ®µç›®æ ‡
                if (cardState.successCount >= this.targetCount) {
                    cardState.level = this.currentLevel;
                }
                
                // æ˜¾ç¤ºæ­£ç¡®åé¦ˆ
                this.keyInput.className = 'key-input correct';
                this.resultMessage.textContent = 'âœ“ æ­£ç¡®ï¼';
                this.resultMessage.className = 'result-message correct';
                
                // æ›´æ–°å‰©ä½™å¡ç‰‡åˆ—è¡¨
                this.updateRemainingCards();
                
                // å»¶è¿Ÿåæ˜¾ç¤ºä¸‹ä¸€ä¸ªå­—æ ¹
                setTimeout(() => {
                    this.nextRadical();
                }, 800);
            }
            
            // å¤„ç†é”™è¯¯ç­”æ¡ˆ
            handleIncorrectAnswer() {
                // æ›´æ–°ç»Ÿè®¡
                this.stats.currentStreak = 0;
                
                // é‡ç½®å½“å‰å¡ç‰‡æˆåŠŸæ¬¡æ•°
                const cardState = this.cardStates[this.currentRadical.radical];
                cardState.successCount = 0; // é”™è¯¯æ—¶æ¸…é›¶
                
                // æ˜¾ç¤ºé”™è¯¯åé¦ˆ
                this.keyInput.className = 'key-input incorrect';
                const keyMap = new Map();
                keyMap['h'] = '1-1'
                keyMap['s'] = '1-2'
                keyMap['z'] = '1-3'
                keyMap['b'] = '1-4'
                keyMap['x'] = '1-5'
                keyMap['m'] = '1-6'
                keyMap['l'] = '2-1'
                keyMap['d'] = '2-2'
                keyMap['y'] = '2-3'
                keyMap['w'] = '2-4'
                keyMap['j'] = '2-5'
                keyMap['n'] = '2-6'
                keyMap['c'] = '3-1'
                keyMap['q'] = '3-2'
                keyMap['g'] = '3-3'
                keyMap['f'] = '3-4'
                keyMap['t'] = '3-5'
                this.resultMessage.textContent = `âœ— é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ "${keyMap[this.currentRadical.key]}"ï¼Œè¯·é‡æ–°è¾“å…¥`;
                this.resultMessage.className = 'result-message incorrect';
                
                // é”™è¯¯åä¸æ¸…é™¤å½“å‰å¡ç‰‡ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥æ­£ç¡®
                // ä¸æ¸…é™¤è¾“å…¥æ¡†ï¼Œè®©ç”¨æˆ·å¯ä»¥ä¿®æ”¹
                
                // é‡æ–°èšç„¦è¾“å…¥æ¡†ï¼Œè®©ç”¨æˆ·å¯ä»¥ç»§ç»­è¾“å…¥
                setTimeout(() => {
                    this.keyInput.focus();
                    this.keyInput.select();
                }, 50);
                
                // æ³¨æ„ï¼šè¿™é‡Œä¸è°ƒç”¨ nextRadical()ï¼Œä¿æŒå½“å‰å¡ç‰‡ç›´åˆ°ç”¨æˆ·ç­”å¯¹
                // æ›´æ–°å‰©ä½™å¡ç‰‡åˆ—è¡¨ï¼ˆé”™è¯¯åå¡ç‰‡ä»ç„¶åœ¨å‰©ä½™åˆ—è¡¨ä¸­ï¼‰
                this.updateRemainingCards();
            }
            
            // åœ¨æ§åˆ¶å°è¾“å‡ºæ‰€æœ‰å¡ç‰‡è¿›åº¦
            logProgress() {
                console.clear();
                console.log('='.repeat(60));
                console.log(`å½“å‰é˜¶æ®µ: ${this.currentLevel + 1}, ç›®æ ‡æ¬¡æ•°: ${this.targetCount}`);
                console.log(`å‰©ä½™å¡ç‰‡æ•°: ${this.remainingCards.length}/${this.radicals.length}`);
                console.log('='.repeat(60));
                
                // æŒ‰å­—æ ¹æ’åºè¾“å‡º
                const sortedRadicals = [...this.radicals].sort((a, b) => a.radical.localeCompare(b.radical));
                
                sortedRadicals.forEach(radical => {
                    const state = this.cardStates[radical.radical];
                    const progressBar = this.createProgressBar(state.successCount, this.targetCount);
                    const levelInfo = state.level > this.currentLevel ? 
                        `(å·²è¿‡å…³ L${state.level + 1})` : 
                        `(å½“å‰ L${this.currentLevel + 1}: ${state.successCount}/${this.targetCount})`;
                    
                    console.log(`${radical.radical.padEnd(5)} -> ${radical.key.padEnd(2)} ${progressBar} ${levelInfo}`);
                });
                
                console.log('='.repeat(60));
                console.log(`ç»Ÿè®¡: æ€»å°è¯• ${this.stats.totalAttempts}, æ­£ç¡® ${this.stats.correctAttempts}, æ­£ç¡®ç‡ ${Math.round((this.stats.correctAttempts / this.stats.totalAttempts) * 100) || 0}%`);
                console.log(`è¿èƒœ: å½“å‰ ${this.stats.currentStreak}, æœ€ä½³ ${this.stats.bestStreak}`);
                console.log('='.repeat(60));
            }
            
            // åˆ›å»ºè¿›åº¦æ¡ï¼ˆç”¨äºæ§åˆ¶å°æ˜¾ç¤ºï¼‰
            createProgressBar(current, max) {
                const width = 10;
                const filled = Math.round((current / max) * width);
                const empty = width - filled;
                return '[' + 'â–ˆ'.repeat(filled) + 'â–‘'.repeat(empty) + ']';
            }
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay() {
                // æ›´æ–°è¿›åº¦ï¼ˆåŸºäºå‰©ä½™å¡ç‰‡æ•°é‡ï¼‰
                const totalCards = this.radicals.length;
                const completedCards = totalCards - this.remainingCards.length;
                const progress = (completedCards / totalCards) * 100;
                this.progressBar.style.width = `${progress}%`;
                
                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                this.remainingCount.textContent = this.remainingCards.length;
                this.currentLevelEl.textContent = this.currentLevel + 1;
                this.targetCountEl.textContent = this.targetCount;
                
                const correctRate = this.stats.totalAttempts > 0 
                    ? Math.round((this.stats.correctAttempts / this.stats.totalAttempts) * 100)
                    : 0;
                
                this.correctRate.textContent = `${correctRate}%`;
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–è®­ç»ƒå™¨
        document.addEventListener('DOMContentLoaded', () => {
            window.trainer = new RandomRadicalTrainer();
            
            // æ·»åŠ é‡ç½®æŒ‰é’®ï¼ˆå¯é€‰ï¼Œç”¨äºè°ƒè¯•ï¼‰
            const resetButton = document.createElement('button');
            resetButton.textContent = 'é‡ç½®è®­ç»ƒ';
            resetButton.style.position = 'fixed';
            resetButton.style.bottom = '10px';
            resetButton.style.right = '10px';
            resetButton.style.padding = '5px 10px';
            resetButton.style.backgroundColor = '#ef4444';
            resetButton.style.color = 'white';
            resetButton.style.border = 'none';
            resetButton.style.borderRadius = '5px';
            resetButton.style.cursor = 'pointer';
            resetButton.style.zIndex = '1000';
            resetButton.onclick = () => {
                if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®­ç»ƒè¿›åº¦å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰ä¿å­˜çš„æ•°æ®ã€‚')) {
                    window.trainer.resetAllStates();
                    window.location.reload();
                }
            };
            document.body.appendChild(resetButton);
            
            // æ·»åŠ å¯¼å‡ºæ•°æ®æŒ‰é’®
            const exportButton = document.createElement('button');
            exportButton.textContent = 'å¯¼å‡ºæ•°æ®';
            exportButton.style.position = 'fixed';
            exportButton.style.bottom = '10px';
            exportButton.style.right = '100px';
            exportButton.style.padding = '5px 10px';
            exportButton.style.backgroundColor = '#4a6ee0';
            exportButton.style.color = 'white';
            exportButton.style.border = 'none';
            exportButton.style.borderRadius = '5px';
            exportButton.style.cursor = 'pointer';
            exportButton.style.zIndex = '1000';
            exportButton.onclick = () => {
                const data = {
                    cardStates: window.trainer.cardStates,
                    appState: {
                        currentLevel: window.trainer.currentLevel,
                        stats: window.trainer.stats
                    }
                };
                const dataStr = JSON.stringify(data, null, 2);
                const blob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'ä¹±17è®­ç»ƒæ•°æ®.json';
                a.click();
                URL.revokeObjectURL(url);
                alert('æ•°æ®å·²å¯¼å‡ºä¸ºJSONæ–‡ä»¶');
            };
            document.body.appendChild(exportButton);
        });
    </script>
</body>
</html>
